---
import { Languages, Tags } from "../utils/consts";
import "../styles/ArticleBody.css";

const { Content, data, availableLanguages } = Astro.props;
---

<script
  is:inline
  define:vars={{ data: data, availableLanguages: availableLanguages }}
>
  const selectedClasses = "bg-yellow-400 text-gray-900 border-yellow-400 scale-110";
  const langButtons = availableLanguages.map((lang) => `lang-${lang}`);

  const removeSelectedFromAll = () => {
    langButtons.forEach((id) => {
      document.getElementById(id).classList.remove(...selectedClasses.split(" "));
    });
  };

  const onPageLoad = () => {
    if (availableLanguages.length > 0) {
      removeSelectedFromAll();
      const firstLangId = `lang-${availableLanguages[0]}`;
      document.getElementById(firstLangId).classList.add(...selectedClasses.split(" "));

      document.querySelectorAll(`.${availableLanguages[0]}-translation`).forEach((element) => {
        element.style.display = "block";
      });

      const otherLanguages = availableLanguages.filter((item) => item != availableLanguages[0]);
      otherLanguages.forEach((lang) => {
        document.querySelectorAll(`.${lang}-translation`).forEach((element) => {
          element.style.display = "none";
        });
      });
    }

    langButtons.forEach((buttonId, languageId) => {
      const language = availableLanguages[languageId];
      document.getElementById(buttonId).onclick = () => {
        removeSelectedFromAll();
        document.getElementById(buttonId).classList.add(...selectedClasses.split(" "));
        document.querySelectorAll(`.${language}-translation`).forEach((element) => {
          element.style.display = "block";
        });
        const otherLanguages = availableLanguages.filter((item) => item != language);
        otherLanguages.forEach((lang) => {
          document.querySelectorAll(`.${lang}-translation`).forEach((element) => {
            element.style.display = "none";
          });
        });
      };
    });
  };

  window.addEventListener("load", () => {
    onPageLoad();
  });
</script>

<div class="w-full relative mt-12">
  <style>
    .parchment-paper {
      position: relative;
      background: #fffef0;
      box-shadow: 
        2px 3px 20px rgba(0, 0, 0, 0.5),
        0 0 100px rgba(139, 89, 34, 0.4) inset;
      padding: 2rem 1.25rem;
      margin: 0;
      width: 100%;
      min-height: 100vh;
    }

    /* Apply wavy edges only to a border element, not the content */
    .parchment-paper::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: transparent;
      border: 1px solid rgba(139, 89, 34, 0.3);
      filter: url(#wavy-edges);
      pointer-events: none;
      z-index: 0;
    }

    @media (min-width: 640px) {
      .parchment-paper {
        padding: 2.5rem 2rem;
      }
    }

    @media (min-width: 768px) {
      .parchment-paper {
        padding: 3rem 3rem;
      }
    }

    @media (min-width: 1024px) {
      .parchment-paper {
        padding: 4rem 5rem;
      }
    }

    .parchment-paper::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: 
        radial-gradient(circle at 20% 30%, rgba(139, 89, 34, 0.06) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(139, 89, 34, 0.06) 0%, transparent 50%),
        radial-gradient(circle at 40% 80%, rgba(139, 89, 34, 0.04) 0%, transparent 40%);
      pointer-events: none;
      z-index: 0;
    }

    #docBody {
      position: relative;
      z-index: 1;
      max-width: 1200px;
      margin: 0 auto;
    }

    #docBody, #docBody * {
      color: #2d1810 !important;
      text-rendering: optimizeLegibility !important;
      -webkit-font-smoothing: antialiased !important;
    }

    #docBody :global(h1), #docBody :global(h2), #docBody :global(h3), #docBody :global(h4) {
      color: #8b4513 !important;
      margin-top: 1.75rem !important;
      margin-bottom: 1rem !important;
      font-weight: 700 !important;
      text-align: center !important;
    }

    @media (min-width: 768px) {
      #docBody :global(h1), #docBody :global(h2), #docBody :global(h3), #docBody :global(h4) {
        margin-top: 2.5rem !important;
        margin-bottom: 1.5rem !important;
      }
    }

    #docBody :global(h1) {
      font-size: 1.625rem !important;
      border-bottom: 2px double rgba(139, 69, 19, 0.5) !important;
      padding-bottom: 0.625rem !important;
    }

    @media (min-width: 768px) {
      #docBody :global(h1) {
        font-size: 2.25rem !important;
        border-bottom: 3px double rgba(139, 69, 19, 0.5) !important;
        padding-bottom: 1rem !important;
      }
    }

    #docBody :global(h2) {
      font-size: 1.375rem !important;
      border-bottom: 2px solid rgba(139, 69, 19, 0.3) !important;
      padding-bottom: 0.5rem !important;
    }

    @media (min-width: 768px) {
      #docBody :global(h2) {
        font-size: 2rem !important;
        padding-bottom: 0.75rem !important;
      }
    }

    #docBody :global(p) {
      color: #2d1810 !important;
      line-height: 1.85rem !important;
      margin-bottom: 1.125rem !important;
      font-size: 0.9375rem !important;
      text-align: left !important;
    }

    @media (min-width: 640px) {
      #docBody :global(p) {
        line-height: 2rem !important;
        font-size: 1rem !important;
        text-align: justify !important;
      }
    }

    @media (min-width: 768px) {
      #docBody :global(p) {
        line-height: 2.2rem !important;
        margin-bottom: 1.5rem !important;
        font-size: 1.05rem !important;
      }
    }

    #docBody :global(.noto-sans-text), #docBody.noto-sans-text, #docBody.noto-sans-text * {
      font-size: 1.0625rem !important;
      line-height: 2.125rem !important;
      color: #1a0d08 !important;
      font-weight: 500 !important;
    }

    @media (min-width: 640px) {
      #docBody :global(.noto-sans-text), #docBody.noto-sans-text, #docBody.noto-sans-text * {
        font-size: 1.1875rem !important;
        line-height: 2.375rem !important;
      }
    }

    @media (min-width: 768px) {
      #docBody :global(.noto-sans-text), #docBody.noto-sans-text, #docBody.noto-sans-text * {
        font-size: 1.25rem !important;
        line-height: 2.5rem !important;
      }
    }

    #docBody :global(strong) {
      color: #6b2c0f !important;
      font-weight: 700 !important;
    }

    #docBody :global(blockquote) {
      border-left: 3px solid #8b4513 !important;
      background: rgba(139, 69, 19, 0.08) !important;
      padding: 1rem 1.25rem !important;
      margin: 1.5rem 0 !important;
      border-radius: 4px !important;
      font-size: 0.9rem !important;
    }

    @media (min-width: 768px) {
      #docBody :global(blockquote) {
        border-left: 5px solid #8b4513 !important;
        padding: 2rem 2.5rem !important;
        margin: 2.5rem 0 !important;
        font-size: 1rem !important;
      }
    }

    #docBody :global(ul), #docBody :global(ol) {
      padding-left: 1.5rem !important;
      margin: 1.25rem 0 !important;
    }

    @media (min-width: 768px) {
      #docBody :global(ul), #docBody :global(ol) {
        padding-left: 2.5rem !important;
        margin: 2rem 0 !important;
      }
    }

    #docBody :global(li) {
      margin-bottom: 0.875rem !important;
      line-height: 2rem !important;
      font-size: 0.9375rem !important;
    }

    @media (min-width: 640px) {
      #docBody :global(li) {
        margin-bottom: 1rem !important;
        line-height: 2.25rem !important;
        font-size: 1rem !important;
      }
    }

    @media (min-width: 768px) {
      #docBody :global(li) {
        margin-bottom: 1.25rem !important;
        line-height: 2.5rem !important;
        font-size: 1.05rem !important;
      }
    }

    #docBody :global(a) {
      color: #a0522d !important;
      border-bottom: 1px dotted #a0522d !important;
      word-break: break-word !important;
    }

    #docBody 
    :global(.sanskrit-shlok),
    :global(.devanagari-translation), #docBody :global(.english-translation), #docBody :global(.hindi-translation) {
      animation: fadeIn 0.5s ease-in-out !important;
      padding: 1.5rem 0 !important;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-15px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>

  <svg style="position: absolute; width: 0; height: 0;">
    <filter id="wavy-edges" x="-50%" y="-50%" width="200%" height="200%">
      <feTurbulence type="fractalNoise" baseFrequency="0.01" numOctaves="4" result="noise" seed="2" />
      <feDisplacementMap in="SourceGraphic" in2="noise" scale="6" xChannelSelector="R" yChannelSelector="G" />
    </filter>
  </svg>

  

  <div class="parchment-paper">
    <div id="docBody" class="noto-sans-text prose prose-lg max-w-none">
      <Content />
    </div>
  </div>
</div>
